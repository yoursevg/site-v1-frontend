(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{9495:function(t,e,a){Promise.resolve().then(a.bind(a,6459))},6459:function(t,e,a){"use strict";a.r(e);var r=a(7437),o=a(2265),s=a(4811);e.default=()=>{let[t,e]=(0,o.useState)([]);return(0,o.useEffect)(()=>{s.Z.getCategories().then(t=>{e(null==t?void 0:t.data.data.map(t=>{var e;return null===(e=t.attributes)||void 0===e?void 0:e.name}))})},[]),(0,r.jsx)("div",{children:(0,r.jsx)("h1",{children:"Загрузка изображений"})})}},4811:function(t,e,a){"use strict";let r=a(7908).Z.create({baseURL:"http://localhost:1337/api"}),o=()=>r.get("posts?populate=*&sort=id").catch(t=>console.error("Ошибка при получении объявлений:",t)),s=async t=>{if(""===t)return o();try{return(await r.post("/graphql",{query:"\n      query SearchPosts($searchTerm: String!) {\n        search(query: $searchTerm) {\n          posts {\n            data {\n              id\n              attributes {\n                title\n                createdAt\n                price\n                stock\n                location\n                description\n                condition\n                category {\n                    data {\n                        attributes {\n                            name\n                        }\n                    }\n                }\n                author {\n                  data {\n                    attributes {\n                      username\n                      first_name\n                      last_name\n                      createdAt\n                      identificator\n                      profile_image_url\n                    }\n                  }\n                }\n                images {\n                  data {\n                    attributes {\n                      url\n                      formats\n                    }\n                  }\n                }\n                users_favorites {\n                  data {\n                    attributes {\n                      identificator\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    ",variables:{searchTerm:t}},{baseURL:"http://localhost:1337"})).data.data.search}catch(t){console.error("Ошибка при попытке поиска объявлений:",t)}},n=async(t,e)=>{try{let a;let o=await r.get("/users?filters[identificator][$eq]=".concat(e));console.log(o);let s=o.data.length>0?o.data[0].id:null;if(!s){console.log("Пользователь не найден");return}let n=(await r.get("/posts/".concat(t,"?populate=users_favorites"))).data.data.attributes.users_favorites.data;a=n.some(t=>t.id===s)?n.filter(t=>t.id!==s):[...n,{id:s}];let c=await r.put("/posts/".concat(t),{data:{users_favorites:a}});console.log("Изменения в избранных сохранены",c)}catch(t){console.error("Ошибка при обновлении списка избранных:",t)}},c=async(t,e,a)=>{try{let o=await r.get("/rooms?filters[$and][0][users]=".concat(t,"&filters[$and][1][users]=").concat(e),{headers:{Authorization:"Bearer ".concat(a)}});if(o.data.data.length>0)return o.data.data[0];return(o=await r.post("/rooms",{data:{users:[t,e]}})).data.data}catch(t){throw console.error("Ошибка при попытке найти или создать комнату:",t),t}};e.Z={getPosts:o,getPostByPostId:t=>r.get("posts/".concat(t,"?populate=*")).catch(t=>console.error("Ошибка при получении объявления:",t)),getCategories:()=>r.get("categories?populate=*&sort=id").catch(t=>console.error("Ошибка при получении категорий:",t)),getPostsByUserId:t=>r.get("posts?populate=*&filters[author][identificator][$eq]=".concat(t)).catch(t=>console.error("Ошибка при получении объявлений:",t)),uploadPhoto:t=>{let e=new FormData;return e.append("files",t),r.post("upload",e,{headers:{"Content-Type":"multipart/form-data"}})},createPost:t=>r.post("posts",{data:{...t}}).catch(t=>console.error("Ошибка при создании объявления:",t)),deletePhoto:t=>r.delete("upload/files/".concat(t)).catch(t=>console.error("Ошибка при получении объявлений:",t)),getFavoritesPostsByUserId:t=>r.get("posts?populate=*&filters[users_favorites][identificator][$eq]=".concat(t)).catch(t=>console.error("Ошибка при получении объявлений:",t)),getPostsByCategory:t=>r.get("posts?populate=*&filters[category][name][$eq]=".concat(t)).catch(t=>console.error("Ошибка при получении объявлений:",t)),getUserIdByIdentificator:t=>r.get("/users?populate=*&filters[identificator][$eq]=".concat(t)).catch(t=>console.error("Ошибка при получении пользователя:",t)),getPostsBySearch:s,updateFavoritesByUserAndPostId:n,findOrCreateRoom:c,getMessages:(t,e)=>r.get("/messages?filters[room]=".concat(t),{headers:{Authorization:"Bearer ".concat(e)}}).catch(t=>console.error("Ошибка при получении сообщений:",t))}}},function(t){t.O(0,[908,971,69,744],function(){return t(t.s=9495)}),_N_E=t.O()}]);